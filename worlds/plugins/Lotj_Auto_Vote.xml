<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Tuesday, September 09, 2014, 7:26 PM -->
<!-- MuClient version 4.84 -->

<!-- Plugin "Lotj_Auto_Vote" generated by Plugin Wizard -->

<!--
Use 'vote help' for a list of commands.
-->

<muclient>
<plugin
   name="Lotj_Auto_Vote"
   author="Xavious"
   id="caaf09332b042429fd095843"
   language="VBscript"
   purpose="Automate voting on TMC"
   save_state="y"
   date_written="2014-09-09 19:24:57"
   requires="4.84"
   version="1.0"
   >
<description trim="y">
<![CDATA[
This plugin was designed to automatically log into your TMC account and vote for LOTJ. Once you set the username, password, and time of day you want to vote, the script should (in theory) vote every day. Note: This script will open up two different browsers windows. The first one will log into your account, then a secondary browser will launch to vote. This plugin require Internet Explorer to work!

Use 'vote help' for a list of commands.

]]>
</description>

</plugin>


<!--  Get our standard constants -->

<include name="constants.vbs"/>

<!--  Aliases  -->

<aliases>
  <alias
   match="vote help"
   enabled="y"
   group="VOTE"
   send_to="12"
   sequence="100"
  >
  <send>world.note"*LOTJ AUTO VOTE COMMANDS*"
world.note"'vote set user &lt;login&gt;'        - Set account login name"
world.note"'vote set password &lt;password&gt;' - Set account login password"
world.note"'vote set time &lt;hour&gt;'         - Set the daily time to vote [1-23]"
world.note "'vote status                   - Display current settings"
world.note"*Example*"
world.note"'vote set user person@someplace.com'"
world.note"'vote set password myPassword'"
world.note"'vote set time 17'  (5:00 PM) ***Hour is in military time***"
world.note ""
world.note"NOTE: Requires Internet Explorer"</send>
  </alias>
  <alias
   match="vote set password *"
   enabled="y"
   group="VOTE"
   send_to="12"
   sequence="100"
  >
  <send>world.SetVariable "password", "%1"
  world.SaveState</send>
  </alias>
  <alias
   match="vote set time *"
   enabled="y"
   group="VOTE"
   send_to="12"
   sequence="100"
  >
  <send>world.SetVariable "vote_time", "%1"
world.SetTimerOption "LOGIN", "hour", "%1"
world.SetTimerOption "LOGIN", "minute", "0"
world.SetTimerOption "LOGIN", "second", "0"
world.SetTimerOption "VOTE", "hour", "%1"
world.SetTimerOption "VOTE", "minute", "0"
world.SaveState</send>
  </alias>
  <alias
   match="vote set user *"
   enabled="y"
   group="VOTE"
   send_to="12"
   sequence="100"
  >
  <send>world.SetVariable "user", "%1"
  world.SaveState</send>
  </alias>
  <alias
   match="vote status"
   enabled="y"
   group="VOTE"
   send_to="12"
   sequence="100"
  >
  <send>dim time
dim user
dim password
time = world.GetVariable ("vote_time")
user = world.GetVariable ("user")
password = world.GetVariable ("password")
world.note "***Vote Settings***"
world.note "Username: " &amp; user
world.note "Password: " &amp; password
world.note "Time    : " &amp; time &amp; ":00"</send>
  </alias>
</aliases>

<!--  Timers  -->

<timers>
  <timer name="LOGIN" enabled="y" hour="20" second="0.00" offset_second="0.00"    send_to="12"
at_time="y" group="VOTE" >
  <send>dim pause
pause = 0
dim user
user = world.GetVariable ("user")
dim password
password = world.GetVariable ("password")
Dim IE 
Set IE = CreateObject("InternetExplorer.Application")
IE.Visible = 1  
IE.navigate "http://www.mudconnect.com/SMF/index.php?action=login"
while IE.Busy
   pause = pause + 1
wend

IE.Document.Forms(1).Elements(0).value = user
IE.Document.Forms(1).Elements(1).value = password
IE.Document.Forms(1).Submit
world.note "You have logged into Mudconnector."</send>

  </timer>
  <timer name="VOTE" enabled="y" hour="20" second="5.00" offset_second="0.00"    send_to="12"
at_time="y" group="VOTE" >
  <send>dim IE
dim pause
pause = 0
Set IE = CreateObject("InternetExplorer.Application")
IE.Visible = 1  
IE.navigate "http://www.mudconnect.com/cgi-bin/vote_rank.cgi?mud=Legends+of+the+Jedi"
while IE.Busy
    pause = pause +1
wend
IE.Document.Forms(1).Submit
world.note "You have placed your vote."</send>

  </timer>
</timers>

<!--  Variables  -->

<variables>
  <variable name="vote_time">17</variable>
  <variable name="user"></variable>
  <variable name="password"></variable>
</variables>

<!--  Script  -->


<script>
<![CDATA[
world.note "***  You have installed Lotj_Auto_Vote 1.0   ***"
world.note "***  For a list of options type: 'vote help' ***"
]]>
</script>


<!--  Plugin help  -->

<aliases>
  <alias
   script="OnHelp"
   match="Lotj_Auto_Vote:help"
   enabled="y"
  >
  </alias>
</aliases>

<script>
<![CDATA[
Sub OnHelp (sName, sLine, wildcards)
  world.Note world.GetPluginInfo (world.GetPluginID, 3)
End Sub
]]>
</script> 

</muclient>
